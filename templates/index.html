<!DOCTYPE html>
<html>
<head>
    <title>websec · scanner next</title>
    <!-- Font Awesome 6 (free) for icons & modern look -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(145deg, #0b0f17 0%, #151b28 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
        }

        .glass-panel {
            max-width: 960px;
            width: 100%;
            background: rgba(18, 25, 40, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(74, 144, 226, 0.2);
            border-radius: 2.5rem;
            padding: 2.5rem 2.2rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8), inset 0 1px 1px rgba(255, 255, 255, 0.06);
        }

        .header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 2rem;
        }

        .header i {
            font-size: 2.2rem;
            background: linear-gradient(135deg, #4f9fff, #3b7ed0);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            filter: drop-shadow(0 4px 8px #1e3b5f);
        }

        .header h2 {
            font-weight: 600;
            font-size: 1.9rem;
            letter-spacing: -0.02em;
            background: linear-gradient(to right, #f0f5ff, #c0d9ff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .header span {
            background: rgba(45, 140, 255, 0.2);
            padding: 0.2rem 1rem;
            border-radius: 40px;
            font-size: 0.75rem;
            font-weight: 500;
            color: #8bb9ff;
            border: 1px solid #2d5580;
            margin-left: 0.75rem;
            text-transform: uppercase;
        }

        .search-section {
            background: rgba(10, 20, 35, 0.7);
            border-radius: 3rem;
            border: 1px solid #2a3b55;
            padding: 0.5rem 0.5rem 0.5rem 1.8rem;
            display: flex;
            align-items: center;
            backdrop-filter: blur(8px);
            margin-bottom: 2.5rem;
            transition: border 0.2s, box-shadow 0.2s;
        }

        .search-section:focus-within {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.25);
        }

        .search-section i {
            color: #5d7fb9;
            font-size: 1.2rem;
        }

        .search-section input {
            background: transparent;
            border: none;
            padding: 1rem 1.2rem;
            font-size: 1.1rem;
            color: #eef4ff;
            width: 100%;
            outline: none;
        }

        .search-section input::placeholder {
            color: #4a6085;
            font-weight: 400;
            letter-spacing: -0.2px;
        }

        .search-section button {
            background: linear-gradient(145deg, #1f3a6b, #122b4e);
            border: none;
            color: white;
            padding: 0.9rem 2.2rem;
            border-radius: 3rem;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.2s;
            border: 1px solid #3166b0;
            box-shadow: 0 6px 14px rgba(0, 30, 70, 0.6);
        }

        .search-section button:hover {
            background: linear-gradient(145deg, #254f8a, #163a63);
            border-color: #4b84d7;
            transform: scale(1.02);
            box-shadow: 0 10px 20px -5px #0f2e55;
        }

        .search-section button i {
            color: #b4d0ff;
        }

        .target-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: #101d31;
            border-radius: 50px;
            padding: 0.6rem 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid #315277;
            font-size: 1.1rem;
        }

        .target-badge i {
            color: #3f90ff;
        }

        .target-badge span {
            color: #bfd7ff;
            font-weight: 500;
        }

        .target-badge .url-value {
            color: white;
            font-family: 'Fira Code', monospace;
            font-weight: 500;
            background: #0a1a2f;
            padding: 0.2rem 1rem;
            border-radius: 40px;
            border: 1px solid #2f4b78;
        }

        .stats-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .stat-chip {
            background: #0d1d31;
            border-radius: 40px;
            padding: 0.5rem 1.2rem;
            border: 1px solid #2d476b;
            display: flex;
            align-items: center;
            gap: 8px;
            color: #b7d0f3;
        }

        .stat-chip i {
            color: #4b8cff;
        }

        .badge-High, .badge-Medium, .badge-Low {
            padding: 0.15rem 0.8rem;
            border-radius: 30px;
            font-weight: 600;
            font-size: 0.7rem;
            letter-spacing: 0.4px;
            text-transform: uppercase;
        }

        .badge-High {
            background: rgba(231, 76, 60, 0.22);
            color: #ff9f94;
            border: 1px solid #b03c2e;
        }
        .badge-Medium {
            background: rgba(243, 156, 18, 0.18);
            color: #fdc15b;
            border: 1px solid #a0741f;
        }
        .badge-Low {
            background: rgba(52, 152, 219, 0.17);
            color: #9ac9ff;
            border: 1px solid #286aa0;
        }

        .results-grid {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .vuln-card {
            background: rgba(12, 23, 41, 0.7);
            backdrop-filter: blur(4px);
            border-radius: 1.8rem;
            padding: 1.5rem 1.8rem;
            border-left: 8px solid;
            transition: transform 0.15s, box-shadow 0.2s;
            box-shadow: 0 10px 20px -10px rgba(0,0,0,0.6);
            border-image: none;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .vuln-card.High {
            border-left-color: #e74c3c;
            background: linear-gradient(145deg, #1d1428, #141a2b);
        }
        .vuln-card.Medium {
            border-left-color: #f39c12;
        }
        .vuln-card.Low {
            border-left-color: #3498db;
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .card-header .severity-tag {
            font-weight: 700;
            font-size: 0.8rem;
            padding: 0.3rem 1rem;
            border-radius: 30px;
        }

        .vuln-name {
            font-size: 1.3rem;
            font-weight: 600;
            color: #e5eeff;
            letter-spacing: -0.3px;
        }

        .owasp-row {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
            color: #a9bfe4;
            background: #0c1a30;
            padding: 0.3rem 1rem;
            border-radius: 30px;
            width: fit-content;
            border: 1px solid #2c4569;
        }

        .owasp-row i {
            color: #e9893a;
        }

        .details-text {
            margin-top: 8px;
            color: #ccdbf7;
            line-height: 1.5;
            background: rgba(0, 15, 35, 0.5);
            padding: 0.9rem 1.2rem;
            border-radius: 1.5rem;
            border: 1px dashed #385a88;
            font-family: 'Fira Code', monospace;
            font-size: 0.9rem;
        }

        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            background: rgba(0, 15, 30, 0.4);
            border-radius: 3rem;
            border: 1px dashed #32527b;
        }

        .empty-state i {
            font-size: 3.5rem;
            color: #3d6192;
            margin-bottom: 1rem;
        }

        .empty-state p {
            color: #a3badd;
            font-size: 1.2rem;
        }

        .footer-note {
            margin-top: 2rem;
            text-align: right;
            color: #416597;
            font-size: 0.8rem;
            border-top: 1px solid #253c5c;
            padding-top: 1.2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .footer-note i {
            color: #5588d1;
            margin: 0 4px;
        }

        .refresh-shield {
            color: #6f95d3;
        }
    </style>
</head>
<body>

<div class="glass-panel">
    <div class="header">
        <i class="fas fa-shield-halved"></i>
        <h2>deep vulnerability scanner</h2>
        <span>next-gen</span>
    </div>

    <!-- scan form – upgraded -->
    <form method="POST">
        <div class="search-section">
            <i class="fas fa-link"></i>
            <input type="text" name="url" placeholder="https://example.com" value="{{ target if target else '' }}" required>
            <button type="submit">
                <i class="fas fa-radar"></i> scan now
            </button>
        </div>
    </form>

    <!-- dynamic target info & quick stats -->
    {% if target %}
    <div class="target-badge">
        <i class="fas fa-bullseye"></i>
        <span>target</span>
        <span class="url-value">{{ target }}</span>
    </div>

    <!-- stats: severity counters (just for show, could be dynamic) -->
    {% set counts = {'High': 0, 'Medium': 0, 'Low': 0} %}
    {% if results %}
        {% for r in results %}
            {% if r.severity == 'High' %}{% set _ = counts.update({'High': counts.High + 1}) %}{% endif %}
            {% if r.severity == 'Medium' %}{% set _ = counts.update({'Medium': counts.Medium + 1}) %}{% endif %}
            {% if r.severity == 'Low' %}{% set _ = counts.update({'Low': counts.Low + 1}) %}{% endif %}
        {% endfor %}
    {% endif %}

    <div class="stats-row">
        <div class="stat-chip"><i class="fas fa-circle-exclamation" style="color:#f36b5b;"></i> High <span style="font-weight:700;margin-left:6px;color:#ffb0a7;">{{ counts.High }}</span></div>
        <div class="stat-chip"><i class="fas fa-chart-line" style="color:#f7b45a;"></i> Medium <span style="font-weight:700;margin-left:6px;color:#fddc9b;">{{ counts.Medium }}</span></div>
        <div class="stat-chip"><i class="fas fa-info-circle" style="color:#6fb3ff;"></i> Low <span style="font-weight:700;margin-left:6px;color:#b7d9ff;">{{ counts.Low }}</span></div>
        <div class="stat-chip"><i class="fas fa-shield"></i> total <span style="font-weight:700;margin-left:6px;">{{ results|length if results else 0 }}</span></div>
    </div>
    {% endif %}

    <!-- results area with next-level cards -->
    <div class="results-grid">
        {% if results %}
            {% for r in results %}
            <div class="vuln-card {{ r.severity }}">
                <div class="card-header">
                    {% if r.severity == 'High' %}
                    <span class="severity-tag badge-High"><i class="fas fa-skull" style="margin-right:5px;"></i>HIGH</span>
                    {% elif r.severity == 'Medium' %}
                    <span class="severity-tag badge-Medium"><i class="fas fa-exclamation-triangle" style="margin-right:5px;"></i>MEDIUM</span>
                    {% elif r.severity == 'Low' %}
                    <span class="severity-tag badge-Low"><i class="fas fa-leaf" style="margin-right:5px;"></i>LOW</span>
                    {% endif %}
                    <span class="vuln-name">{{ r.name }}</span>
                </div>

                <div class="owasp-row">
                    <i class="fas fa-bug"></i> OWASP: {{ r.owasp }}
                </div>

                <div class="details-text">
                    <i class="fas fa-chevron-right" style="color:#4f8eff; font-size:0.7rem; margin-right:8px;"></i>
                    {{ r.details }}
                </div>

                <!-- tiny extra meta (simulates real scanner output) -->
                <div style="display:flex; gap:20px; margin-top:5px; color:#5b749b; font-size:0.75rem; padding-left:5px;">
                    <span><i class="far fa-clock"></i> 43 ms</span>
                    <span><i class="fas fa-code-branch"></i> vector: network</span>
                </div>
            </div>
            {% endfor %}

        {% elif target %}
            <!-- no findings but target scanned -->
            <div class="empty-state">
                <i class="fas fa-shield-check"></i>
                <p>✅ no vulnerabilities detected</p>
                <span style="color:#6082b0;">target is clean · surface looks healthy</span>
            </div>
        {% else %}
            <!-- initial state (no scan) -->
            <div class="empty-state" style="background:transparent; border-color:#273d5e;">
                <i class="fas fa-satellite-dish"></i>
                <p>enter a URL to start passive analysis</p>
                <span style="color:#51729c;">deep inspection • owasp top 10 • real‑time</span>
            </div>
        {% endif %}
    </div>

    <!-- footer with extra swag -->
    <div class="footer-note">
        <span><i class="fas fa-shield"></i> next‑level scanner • owasp compliant</span>
        <span class="refresh-shield">
            <i class="fas fa-sync-alt"></i> live  <i class="fas fa-circle" style="color:#4ef97e; font-size:0.5rem;"></i>
        </span>
    </div>
</div>

<!-- tiny script just to update stats consistency (not needed for display, but keeps counters if you want dynamic) -->
<!-- note: counts.High etc are calculated above, but we can also add small interactive later. -->
</body>
</html>